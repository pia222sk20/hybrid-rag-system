# ğŸ¯ Hybrid RAG System - ì™„ì „í•œ ì‹¤í–‰ ê°€ì´ë“œ

## ğŸ“ í”„ë¡œì íŠ¸ ìœ„ì¹˜
```
C:\001.CLAUD\hybrid-rag-system
```

---

## âœ… ìƒì„±ëœ íŒŒì¼ ëª©ë¡

### ğŸ“‚ í•µì‹¬ êµ¬ì¡°
```
hybrid-rag-system/
â”œâ”€â”€ ğŸ“„ README.md                    # ìƒì„¸ ë¬¸ì„œ
â”œâ”€â”€ ğŸ“„ QUICKSTART.md                # ë¹ ë¥¸ ì‹œì‘
â”œâ”€â”€ ğŸ“„ requirements.txt             # íŒ¨í‚¤ì§€ ëª©ë¡
â”œâ”€â”€ ğŸ“„ .env.example                 # í™˜ê²½ë³€ìˆ˜ í…œí”Œë¦¿
â”œâ”€â”€ ğŸ“„ .gitignore                   # Git ì œì™¸ ëª©ë¡
â”œâ”€â”€ ğŸ“„ Dockerfile                   # Docker ì´ë¯¸ì§€
â”œâ”€â”€ ğŸ“„ setup.bat / setup.sh         # ì„¤ì¹˜ ìŠ¤í¬ë¦½íŠ¸
â”œâ”€â”€ ğŸ“„ run_server.bat / run_server.sh # ì‹¤í–‰ ìŠ¤í¬ë¦½íŠ¸
â”‚
â”œâ”€â”€ ğŸ“ config/
â”‚   â””â”€â”€ settings.py                 # ì„¤ì • ê´€ë¦¬
â”‚
â”œâ”€â”€ ğŸ“ src/
â”‚   â”œâ”€â”€ core/                       # ë¬¸ì„œ ì²˜ë¦¬
â”‚   â”‚   â”œâ”€â”€ document_loader.py
â”‚   â”‚   â”œâ”€â”€ semantic_chunker.py
â”‚   â”‚   â””â”€â”€ embeddings.py
â”‚   â”œâ”€â”€ retrieval/                  # ê²€ìƒ‰ ì‹œìŠ¤í…œ
â”‚   â”‚   â”œâ”€â”€ dense_retriever.py
â”‚   â”‚   â”œâ”€â”€ sparse_retriever.py
â”‚   â”‚   â””â”€â”€ hybrid_retriever.py
â”‚   â”œâ”€â”€ generation/                 # ë‹µë³€ ìƒì„±
â”‚   â”‚   â””â”€â”€ rag_chain.py
â”‚   â””â”€â”€ utils/
â”‚       â””â”€â”€ logger.py
â”‚
â”œâ”€â”€ ğŸ“ api/
â”‚   â”œâ”€â”€ main.py                     # FastAPI ì•±
â”‚   â”œâ”€â”€ models.py                   # ë°ì´í„° ëª¨ë¸
â”‚   â””â”€â”€ routers/
â”‚       â””â”€â”€ rag.py                  # API ì—”ë“œí¬ì¸íŠ¸
â”‚
â”œâ”€â”€ ğŸ“ data/
â”‚   â””â”€â”€ raw/                        # âš ï¸ ì—¬ê¸°ì— DOCX íŒŒì¼ ë„£ê¸°
â”‚
â”œâ”€â”€ ğŸ“ index/                       # ìë™ ìƒì„±ë¨
â””â”€â”€ ğŸ“ tests/
    â””â”€â”€ test_api.py                 # API í…ŒìŠ¤íŠ¸
```

---

## ğŸš€ ì‹¤í–‰ ë°©ë²• (Windows)

### ë°©ë²• 1: ìë™ ìŠ¤í¬ë¦½íŠ¸ (ê¶Œì¥)

#### Step 1: ì„¤ì¹˜
```cmd
# setup.bat ë”ë¸”í´ë¦­ ë˜ëŠ”
setup.bat
```

ì„¤ì¹˜ ìŠ¤í¬ë¦½íŠ¸ê°€ ìë™ìœ¼ë¡œ:
- âœ… ê°€ìƒí™˜ê²½ ìƒì„±
- âœ… íŒ¨í‚¤ì§€ ì„¤ì¹˜
- âœ… .env íŒŒì¼ ìƒì„±
- âœ… í´ë” êµ¬ì¡° ìƒì„±

#### Step 2: í™˜ê²½ë³€ìˆ˜ ì„¤ì •
`.env` íŒŒì¼ì´ ìë™ìœ¼ë¡œ ì—´ë¦½ë‹ˆë‹¤. OpenAI API í‚¤ ì…ë ¥:
```env
OPENAI_API_KEY=sk-proj-your-actual-key-here
```

#### Step 3: ë¬¸ì„œ ì¤€ë¹„
```cmd
# data/raw/ í´ë”ì— .docx íŒŒì¼ ë³µì‚¬
# ì˜ˆ: report.docx, manual.docx
```

#### Step 4: ì„œë²„ ì‹¤í–‰
```cmd
# run_server.bat ë”ë¸”í´ë¦­ ë˜ëŠ”
run_server.bat
```

#### Step 5: API í…ŒìŠ¤íŠ¸
ë¸Œë¼ìš°ì € ì—´ê¸°:
```
http://localhost:8000/docs
```

---

### ë°©ë²• 2: ìˆ˜ë™ ì‹¤í–‰

```cmd
# 1. ê°€ìƒí™˜ê²½ ìƒì„±
python -m venv venv

# 2. ê°€ìƒí™˜ê²½ í™œì„±í™”
venv\Scripts\activate

# 3. íŒ¨í‚¤ì§€ ì„¤ì¹˜
pip install -r requirements.txt

# 4. í™˜ê²½ë³€ìˆ˜ ì„¤ì •
copy .env.example .env
notepad .env  # API í‚¤ ì…ë ¥

# 5. ì„œë²„ ì‹¤í–‰
uvicorn api.main:app --reload
```

---

## ğŸ ì‹¤í–‰ ë°©ë²• (macOS/Linux)

```bash
# 1. ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ ê¶Œí•œ ë¶€ì—¬
chmod +x setup.sh run_server.sh

# 2. ì„¤ì¹˜
./setup.sh

# 3. í™˜ê²½ë³€ìˆ˜ í¸ì§‘
nano .env  # OpenAI API í‚¤ ì…ë ¥

# 4. ë¬¸ì„œ ì¶”ê°€
cp your_documents/*.docx data/raw/

# 5. ì„œë²„ ì‹¤í–‰
./run_server.sh
```

---

## ğŸ“¡ API ì‚¬ìš© ì˜ˆì‹œ

### 1ï¸âƒ£ ë¬¸ì„œ ì¸ë±ì‹±

**Swagger UI ì‚¬ìš©:**
```
http://localhost:8000/docs
â†’ POST /api/v1/reindex ì‹¤í–‰
```

**cURL ì‚¬ìš©:**
```bash
curl -X POST http://localhost:8000/api/v1/reindex \
  -H "Content-Type: application/json" \
  -d '{"reset_existing": true}'
```

**Python ì‚¬ìš©:**
```python
import requests

response = requests.post(
    "http://localhost:8000/api/v1/reindex",
    json={"reset_existing": True}
)
print(response.json())
```

---

### 2ï¸âƒ£ RAG ì§ˆì˜ì‘ë‹µ

**Swagger UI:**
```
POST /api/v1/query
{
  "question": "ë¬¸ì„œì˜ ì£¼ìš” ë‚´ìš©ì„ ìš”ì•½í•´ì£¼ì„¸ìš”",
  "top_k": 5
}
```

**cURL:**
```bash
curl -X POST http://localhost:8000/api/v1/query \
  -H "Content-Type: application/json" \
  -d '{
    "question": "ë¬¸ì„œì˜ ì£¼ìš” ë‚´ìš©ì„ ìš”ì•½í•´ì£¼ì„¸ìš”",
    "top_k": 5,
    "include_sources": true
  }'
```

**Python:**
```python
import requests

response = requests.post(
    "http://localhost:8000/api/v1/query",
    json={
        "question": "ë¬¸ì„œì˜ ì£¼ìš” ë‚´ìš©ì„ ìš”ì•½í•´ì£¼ì„¸ìš”",
        "top_k": 5,
        "include_sources": True
    }
)

result = response.json()
print(f"ë‹µë³€: {result['answer']}")
print(f"ì‹ ë¢°ë„: {result['confidence']}")
print(f"ì¶œì²˜: {result['sources']}")
```

---

### 3ï¸âƒ£ í†µê³„ ì¡°íšŒ

```bash
curl http://localhost:8000/api/v1/stats
```

---

## ğŸ§ª í…ŒìŠ¤íŠ¸ ì‹¤í–‰

```bash
# ê°€ìƒí™˜ê²½ í™œì„±í™” í›„
pytest tests/ -v

# ì»¤ë²„ë¦¬ì§€ í¬í•¨
pytest tests/ --cov=src --cov-report=html
```

---

## ğŸ”§ ë¬¸ì œ í•´ê²°

### âŒ "OpenAI API key not found"
**í•´ê²°:**
```cmd
# .env íŒŒì¼ í™•ì¸
notepad .env

# ì˜¬ë°”ë¥¸ í˜•ì‹:
OPENAI_API_KEY=sk-proj-ì‹¤ì œí‚¤ì…ë ¥
```

---

### âŒ "No documents found"
**í•´ê²°:**
```cmd
# data/raw í´ë”ì— .docx íŒŒì¼ì´ ìˆëŠ”ì§€ í™•ì¸
dir data\raw

# íŒŒì¼ ë³µì‚¬
copy your_document.docx data\raw\
```

---

### âŒ "Module not found"
**í•´ê²°:**
```cmd
# ê°€ìƒí™˜ê²½ì´ í™œì„±í™”ë˜ì—ˆëŠ”ì§€ í™•ì¸
# í”„ë¡¬í”„íŠ¸ì— (venv)ê°€ ë³´ì—¬ì•¼ í•¨

# íŒ¨í‚¤ì§€ ì¬ì„¤ì¹˜
pip install -r requirements.txt
```

---

### âŒ "Port 8000 already in use"
**í•´ê²°:**
```cmd
# ë‹¤ë¥¸ í¬íŠ¸ ì‚¬ìš©
uvicorn api.main:app --reload --port 8001
```

---

## ğŸ¯ ì™„ì „í•œ ì‹¤í–‰ íë¦„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. setup.bat ì‹¤í–‰                  â”‚
â”‚     (ê°€ìƒí™˜ê²½ + íŒ¨í‚¤ì§€ ì„¤ì¹˜)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  2. .env íŒŒì¼ í¸ì§‘                  â”‚
â”‚     OPENAI_API_KEY ì…ë ¥             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  3. data/raw/ ì— .docx íŒŒì¼ ì¶”ê°€   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  4. run_server.bat ì‹¤í–‰             â”‚
â”‚     http://localhost:8000           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  5. Swagger UI ì ‘ì†                 â”‚
â”‚     http://localhost:8000/docs      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  6. POST /api/v1/reindex            â”‚
â”‚     (ë¬¸ì„œ ì¸ë±ì‹±)                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  7. POST /api/v1/query              â”‚
â”‚     (ì§ˆì˜ì‘ë‹µ í…ŒìŠ¤íŠ¸)               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š ì„±ëŠ¥ íŒ

### ë¹ ë¥¸ ì‘ë‹µì´ í•„ìš”í•œ ê²½ìš°:
```env
EMBEDDING_MODEL=text-embedding-3-small
LLM_MODEL=gpt-4o-mini
TOP_K_FINAL=3
```

### ë†’ì€ ì •í™•ë„ê°€ í•„ìš”í•œ ê²½ìš°:
```env
EMBEDDING_MODEL=text-embedding-3-large
LLM_MODEL=gpt-4o
TOP_K_FINAL=7
```

---

## ğŸ“ ì§€ì›

ë¬¸ì œ ë°œìƒ ì‹œ:
1. âœ… ì´ ë¬¸ì„œì˜ "ë¬¸ì œ í•´ê²°" ì„¹ì…˜ í™•ì¸
2. âœ… `logs/` í´ë”ì˜ ë¡œê·¸ íŒŒì¼ í™•ì¸
3. âœ… GitHub Issues ìƒì„±

---

## ğŸ‰ ì„±ê³µì ì¸ ì‹¤í–‰ í™•ì¸

ì„œë²„ê°€ ì •ìƒ ì‘ë™í•˜ë©´ ë‹¤ìŒì´ ë³´ì…ë‹ˆë‹¤:

```
INFO:     Uvicorn running on http://0.0.0.0:8000
INFO:     Application startup complete.
==================================================
Starting Hybrid RAG System API
LLM Model: gpt-4o-mini
Embedding Model: text-embedding-3-large
==================================================
```

ë¸Œë¼ìš°ì €ì—ì„œ `http://localhost:8000/docs` ì ‘ì† ì‹œ Swagger UIê°€ ë³´ì´ë©´ **ì„±ê³µ!** ğŸŠ

---

## â­ï¸ ë‹¤ìŒ ë‹¨ê³„

âœ… **ê¸°ë³¸ ì‹¤í–‰ ì™„ë£Œ**

ì´ì œ ë‹¤ìŒì„ ì‹œë„í•´ë³´ì„¸ìš”:
- ğŸ”— Firebase/Cloud Run ë°°í¬
- ğŸ” ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§ ì„¤ì •
- ğŸ§ª ë‹¤ì–‘í•œ ë¬¸ì„œë¡œ í…ŒìŠ¤íŠ¸
- ğŸ“ˆ í‰ê°€ ë©”íŠ¸ë¦­ ì¶”ê°€

ì „ì²´ ë¬¸ì„œëŠ” `README.md` ì°¸ì¡°!
